<div class="header">
  <!-- Top Utility Bar -->
  <div class="header-top">
    <div class="header-top-content">
      <div class="header-location">
        <span class="location-label">You're Shopping</span>
        <div class="location-selector-wrapper">
          <button class="location-selector" id="location-selector">
            <span class="location-name">Premium Commercial Builders - Los Angeles, CA</span>
            <span class="location-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg></span>
          </button>
          <!-- Location Dropdown -->
          <div class="location-menu" id="location-menu">
            <div class="location-menu-content">
              <ul class="location-menu-list" id="location-menu-list">
                <!-- Locations will be populated by JavaScript -->
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="header-top-links">
        <a href="pages/order-history.html">Order History</a>
        <a href="pages/account.html#lists">My Lists</a>
        <a href="pages/account.html#help">Help</a>
      </div>
    </div>
  </div>

  <!-- Main Header -->
  <div class="header-main">
    <div class="header-main-content">
      <div class="header-brand">
        <a href="index.html">BuildRight</a>
      </div>
      
      <!-- Search Bar -->
      <div class="header-search">
        <input type="search" placeholder="Search products, SKUs, or keywords..." class="search-input" id="header-search-input">
        <button class="search-button" aria-label="Search">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M19 19L14.65 14.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

      <div class="header-actions">
        <a href="pages/login.html" class="header-action-link">
          <span class="action-label">Login</span>
        </a>
        <span class="action-separator">|</span>
        <a href="pages/login.html" class="header-action-link">
          <span class="action-label">Create Account</span>
        </a>
        <a href="pages/cart.html" class="cart-link">
          <span class="cart-icon">ðŸ›’</span>
          <span class="cart-label">Cart</span>
          <span class="cart-count">0</span>
        </a>
      </div>
    </div>
  </div>

  <!-- Navigation Bar -->
  <div class="header-nav-bar">
    <div class="header-nav-content">
      <button class="menu-toggle" id="menu-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
        <nav class="main-nav">
          <div class="nav-item">
            <a href="catalog" class="nav-link" data-category="all">All Products</a>
          </div>
          <div class="nav-item">
            <a href="pages/project-builder.html" class="nav-link nav-link-cta">Project Builder</a>
          </div>
          <div class="nav-item">
            <button class="nav-link" data-category="structural_materials">Structural Materials</button>
          </div>
          <div class="nav-item">
            <button class="nav-link" data-category="windows_doors">Windows & Doors</button>
          </div>
          <div class="nav-item">
            <button class="nav-link" data-category="fasteners_hardware">Fasteners & Hardware</button>
          </div>
          <div class="nav-item">
            <button class="nav-link" data-category="roofing">Roofing</button>
          </div>
          <div class="nav-item">
            <button class="nav-link" data-category="framing_drywall">Framing & Drywall</button>
          </div>
        </nav>
        <!-- Inline script to set active state immediately, preventing layout shift -->
        <script>
          (function() {
            // Check if we were redirected via 404 (sessionStorage will have the original path)
            const redirectPath = sessionStorage.getItem('spa_redirect_path');
            const currentPath = redirectPath || window.location.pathname;
            const normalizePath = (path) => path ? path.replace(/^\/+|\/+$/g, '').toLowerCase() : '';
            const normalizedCurrentPath = normalizePath(currentPath);
            const isOnCatalog = normalizedCurrentPath.includes('catalog');
            const isOnProjectBuilder = normalizedCurrentPath.includes('project-builder');
            
            // Determine active category from path
            let currentCategory = null;
            if (isOnCatalog) {
              const pathParts = normalizedCurrentPath.split('/');
              if (pathParts.length > 1) {
                const categorySlug = pathParts[1];
                const categoryMap = {
                  'structural-materials': 'structural_materials',
                  'windows-doors': 'windows_doors',
                  'fasteners-hardware': 'fasteners_hardware',
                  'roofing': 'roofing',
                  'framing-drywall': 'framing_drywall'
                };
                currentCategory = categoryMap[categorySlug] || null;
              }
            }
            
            // Apply active state to matching nav link
            document.querySelectorAll('.nav-link').forEach(link => {
              const linkCategory = link.getAttribute('data-category');
              const linkHref = link.getAttribute('href');
              const normalizedLinkHref = normalizePath(linkHref);
              let isActive = false;
              
              if (isOnProjectBuilder) {
                isActive = linkHref && normalizedLinkHref.includes('project-builder');
              } else if (isOnCatalog) {
                if (currentCategory) {
                  isActive = linkCategory === currentCategory;
                } else {
                  isActive = linkCategory === 'all';
                }
              }
              
              if (isActive) {
                link.classList.add('active');
                link.setAttribute('aria-current', 'page');
              }
            });
          })();
        </script>
      <div class="nav-industry">
        <button class="industry-toggle" id="industry-toggle" aria-expanded="false">
          Shop By Industry
          <span class="industry-toggle-icon">â–¼</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Industry Dropdown -->
  <div class="industry-menu" id="industry-menu">
    <div class="industry-menu-content">
        <div class="industry-column">
          <h3>Commercial</h3>
          <ul>
            <li><a href="catalog/commercial">Commercial Construction</a></li>
            <li><a href="catalog/structural-materials">Structural Materials</a></li>
            <li><a href="catalog/windows-doors">Windows & Doors</a></li>
          </ul>
        </div>
        <div class="industry-column">
          <h3>Residential</h3>
          <ul>
            <li><a href="catalog/residential">Residential Construction</a></li>
            <li><a href="catalog/structural-materials">Framing Materials</a></li>
            <li><a href="catalog/windows-doors">Residential Windows</a></li>
          </ul>
        </div>
        <div class="industry-column">
          <h3>Pro</h3>
          <ul>
            <li><a href="catalog/pro">Trade Contractors</a></li>
            <li><a href="catalog/fasteners-hardware">Fasteners & Tools</a></li>
            <li><a href="catalog/roofing">Roofing Supplies</a></li>
          </ul>
        </div>
    </div>
  </div>
</div>
